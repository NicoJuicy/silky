using System;
using Microsoft.OpenApi.Models;

namespace Silky.Swagger.Gen.Configuration;

public class SwaggerDocumentOptions
{
    internal static string SwaggerDocument = "SwaggerDocument";

    public bool EnableAuthorized { get; set; }

    public SpecificationOpenApiSecurityScheme[] SecurityDefinitions { get; set; }
    public string[] XmlComments { get; set; }
    public bool EnableMultipleServiceKey { get; set; }

    public SwaggerDocumentOptions()
    {
        EnableMultipleServiceKey = true;
        EnableAuthorized = true;
        if (EnableAuthorized)
        {
            SecurityDefinitions ??= new SpecificationOpenApiSecurityScheme[]
            {
                new()
                {
                    Id = "Bearer",
                    Type = SecuritySchemeType.ApiKey,
                    Name = "Authorization",
                    Description = "JWT Authorization header using the Bearer scheme.",
                    BearerFormat = "JWT",
                    Scheme = "Bearer",
                    In = ParameterLocation.Header,
                    Requirement = new SpecificationOpenApiSecurityRequirementItem
                    {
                        Scheme = new OpenApiSecurityScheme
                        {
                            Reference = new OpenApiReference
                            {
                                Id = "Bearer",
                                Type = ReferenceType.SecurityScheme
                            },
                            Name = "Bearer",
                            In = ParameterLocation.Header,
                        },
                        Accesses = Array.Empty<string>()
                    }
                }
            };
        }
    }
}